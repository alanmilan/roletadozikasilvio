<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <title>Roleta do Zika Silvio</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@500;700&display=swap');

        body {
            background: #070a1a;
            color: white;
            font-family: Arial, sans-serif;
            text-align: center;
            padding: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            margin: 0;
        }

        .logo-roleta {
            max-width: 400px;
            height: auto;
            margin-top: 20px;
            margin-bottom: 30px;
            filter: drop-shadow(0 0 15px #cc00ff);
        }

        .roleta-wrapper {
            width: 90%;
            max-width: 900px;
            margin: 30px auto 0 auto;
        }

        .roleta-container {
            width: 100%;
            margin: 0; 
            overflow: hidden;
            border: 3px solid #333;
            border-radius: 15px;
            background: #1c1c1c;
            position: relative;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
        }

        .roleta-header {
            display: flex;
            justify-content: flex-end; 
            margin-bottom: 5px;
            width: 100%;
        }

        #lifeCounter {
            font-size: 28px;
            color: #ff3333;
            text-shadow: 0 0 8px rgba(255, 51, 51, 0.7);
            font-family: 'Orbitron', sans-serif;
            margin-right: 15px;
        }

        .roleta {
            display: flex;
            position: relative;
            transition: transform 0.5s ease;
            min-height: 180px;
            align-items: center;
            font-family: 'Orbitron', sans-serif;
        }

        .item {
            min-width: 180px;
            height: 180px;
            margin: 0 10px;
            background: #262042;
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 16px;
            font-weight: 700;
            padding: 6px;
            box-sizing: border-box;
            flex-shrink: 0;
            white-space: nowrap;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.4);
            text-overflow: ellipsis;
            overflow: hidden;
            color: #fff;
            text-shadow: 0 0 6px rgba(255,255,255,0.12);
        }

        .item img {
            display: block;
            margin: 0 auto 6px;
            max-height: 115px;
            width: auto;
            object-fit: contain;
        }

        .premios-barra {
            display: flex;
            justify-content: center;
            overflow-x: auto;
            margin-top: 20px;
            border-radius: 10px;
            background: #0c0c1f;
            padding: 5px;
            gap: 6px;
            width: 90%;
            max-width: 900px;
        }

        .premio-box {
            flex: 0 0 auto;
            min-width: 110px;
            max-width: 140px;
            text-align: center;
            padding: 8px 6px;
            color: #fff;
            font-size: 13px;
            font-weight: 700;
            border-radius: 8px;
            white-space: nowrap;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 4px;
        }

        .premio-box img {
            display: block;
            margin: 0 auto;
            max-height: 40px;
            width: auto;
            object-fit: contain;
        }

        .premio-REPICK { background: #ff3b3b; color: #fff; }
        .premio-TIMEOUT { background: #6b6b6b; color: #fff; }
        .premio-SKIN_50 { background: #0fbf7e; color: #022; }
        .premio-SKIN_75 { background: #cc00ff; color: #fff; }
        .premio-SKIN_100 { background: #4a2c2c; color: #fff; }
        .premio-PIX_50 { background: #007bff; color: #fff; }
        .premio-SKIN_200 { background: #f39c12; color: #111; }

        .item.highlight {
            background: #ffcc00;
            color: #000;
            box-shadow: 0 0 25px #ffcc00, inset 0 0 10px rgba(0, 0, 0, 0.5);
            transform: scale(1.15);
            transition: all 0.3s ease;
        }

        .roleta-pointer {
            position: absolute;
            top: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 20px solid transparent;
            border-right: 20px solid transparent;
            border-top: 30px solid #cc00ff;
            z-index: 10;
            filter: drop-shadow(0 0 5px rgba(0, 0, 0, 0.7));
        }

        #confetti {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            pointer-events: none;
            background: radial-gradient(circle, rgba(255,255,255,0.2) 0%, transparent 70%);
            animation: piscar 0.15s infinite alternate;
            display: none;
            z-index: 999;
        }
        @keyframes piscar { from { opacity: 0.2; } to { opacity: 0.8; } }

        #explosao {
            position: fixed;
            top: 50%;
            left: 50%;
            width: 200px;
            height: 200px;
            background: radial-gradient(circle, #ff0000, transparent 60%);
            border-radius: 50%;
            transform: translate(-50%, -50%) scale(0);
            opacity: 0;
            pointer-events: none;
            z-index: 1000;
            animation: none;
        }
        @keyframes boom {
            0% { transform: translate(-50%, -50%) scale(0.5); opacity: 0.9; }
            50% { transform: translate(-50%, -50%) scale(1.5); opacity: 1; }
            100% { transform: translate(-50%, -50%) scale(2); opacity: 0; }
        }

        .button-group {
            display: flex;
            justify-content: center;
            align-items: center;
            margin-top: 15px;
        }

        button {
            margin: 15px 10px;
            background: #cc00ff;
            color: white;
            padding: 15px 25px;
            font-size: 18px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            transition: background 0.3s ease, transform 0.2s ease;
            box-shadow: 0 5px 10px rgba(0, 0, 0, 0.3);
        }
        button:hover { background: #9900cc; transform: translateY(-2px); }
        button:disabled { background: #555; cursor: not-allowed; opacity: 0.7; }

        #resetLivesBtn {
            background: #337ab7; 
        }
        #resetLivesBtn:hover {
            background: #286090;
        }

        #resultado { margin-top: 30px; font-size: 28px; font-weight: bold; min-height: 40px; text-shadow: 0 0 10px rgba(204, 0, 255, 0.5); }
        #probReal { margin-top: 10px; font-size: 18px; color: #ccc; min-height: 24px; }

        footer { margin-top: 40px; padding: 20px 0; color: #aaa; font-size: 14px; }
        footer a { color: #cc00ff; text-decoration: none; }
        footer a:hover { text-decoration: underline; }
    </style>
</head>
<body>
    <img src="roletalogo.png" alt="Logo Roleta do Zika Silvio" class="logo-roleta" />

    <div class="roleta-wrapper">
        <div class="roleta-header">
            <div id="lifeCounter"></div>
        </div>
        <div class="roleta-container">
            <div class="roleta" id="roleta"></div>
            <div class="roleta-pointer"></div>
        </div>
    </div>

    <div class="premios-barra" id="barraPremios"></div>

    <div class="button-group">
        <button id="spinBtn">Girar Roleta</button>
        <button id="resetLivesBtn">Resetar Vidas</button> 
    </div>

    <h2 id="resultado"></h2>
    <p id="probReal"></p>

    <div id="confetti"></div>
    <div id="explosao"></div>

    <audio id="tickSound" src="tick_sound.mp3" preload="auto"></audio>
    <audio id="winSound" src="https://www.soundjay.com/button/button-3.wav" preload="auto"></audio>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const premios = [
                { valor: "REPICK", prob: 0.03, imagem: "images/repick.png" },
                { valor: "TIMEOUT", prob: 0.07, imagem: "images/timeout.png" },
                { valor: "SKIN_50", prob: 0.28, imagem: "images/50.png" },
                { valor: "SKIN_75", prob: 0.28, imagem: "images/75.png" },
                { valor: "SKIN_100", prob: 0.14, imagem: "images/100.png" },
                { valor: "PIX_50", prob: 0.14, imagem: "images/pix.png" },
                { valor: "SKIN_200", prob: 0.06, imagem: "images/200.png" }
            ];

            const roleta = document.getElementById("roleta");
            const resultado = document.getElementById("resultado");
            const probReal = document.getElementById("probReal");
            const spinBtn = document.getElementById("spinBtn");
            const resetLivesBtn = document.getElementById("resetLivesBtn"); 
            const lifeCounter = document.getElementById("lifeCounter");     
            const winSound = document.getElementById("winSound");
            const tickSound = document.getElementById("tickSound");
            const confetti = document.getElementById("confetti");

            let isSpinning = false;
            const itemFullWidth = 200;
            let clones = [];
            let vidas = 3; 

            function atualizarContadorVidas() {
                const coracaoCheio = "‚ù§Ô∏è";
                const coracaoVazio = "üñ§";
                let coracoes = "";
                for (let i = 0; i < 3; i++) {
                    coracoes += (i < vidas) ? coracaoCheio : coracaoVazio;
                }
                lifeCounter.textContent = coracoes;
                spinBtn.disabled = isSpinning || vidas <= 0;
                if (vidas <= 0 && !isSpinning) {
                    resultado.textContent = "Vidas Esgotadas! Resete para continuar. üíÄ";
                    resultado.style.color = "#ff3333";
                } else if (vidas > 0 && !isSpinning && resultado.textContent.includes("Esgotadas")) {
                    resultado.textContent = ""; 
                }
            }

            function preencherBarraPremios() {
                const barra = document.getElementById("barraPremios");
                barra.innerHTML = "";
                premios.forEach(p => {
                    const div = document.createElement("div");
                    const classValue = p.valor.replace(/[^a-zA-Z0-9]/g, '_');
                    div.className = `premio-box premio-${classValue}`;
                    div.innerHTML = `<img src='${p.imagem}' alt='${p.valor}' /><div>${p.valor.replace(/_/g, ' ')}</div><small>${(p.prob * 100).toFixed(0)}%</small>`;
                    barra.appendChild(div);
                });
            }

            function escolherPremio() {
                let r = Math.random();
                let acumulado = 0;
                for (let premio of premios) {
                    acumulado += premio.prob;
                    if (r < acumulado) return { premio, r };
                }
                return { premio: premios[premios.length - 1], r };
            }

            function gerarItens() {
                roleta.innerHTML = "";
                clones = [];
                for (let i = 0; i < 120; i++) {
                    const premio = premios[Math.floor(Math.random() * premios.length)];
                    const item = document.createElement("div");
                    item.className = "item";
                    item.dataset.valor = premio.valor;
                    item.innerHTML = `<img src='${premio.imagem}' alt='${premio.valor}' /><div>${premio.valor.replace(/_/g, ' ')}</div>`;
                    roleta.appendChild(item);
                    clones.push(item);
                }
                roleta.style.width = `${clones.length * itemFullWidth}px`;
                roleta.style.transition = "none";
                roleta.style.transform = "translateX(0)";
            }

            function iniciarTickDuranteGiro(duracaoTotal) {
                let lastX = null, lastTickTime = 0, lastHighlightIndex = -1;
                const tickIntervalMin = 30, tickIntervalMax = 300;
                const startTime = performance.now();
                const containerCenter = roleta.parentElement.offsetWidth / 2;

                function tickLoop(now) {
                    const elapsed = now - startTime;
                    if (elapsed >= duracaoTotal - 800) return;
                    const matrix = new DOMMatrix(getComputedStyle(roleta).transform);
                    const currentX = matrix.m41;

                    if (lastX !== null) {
                        const delta = Math.abs(currentX - lastX);
                        const idealInterval = Math.max(tickIntervalMin, Math.min(tickIntervalMax, 1000 / (delta + 0.1)));
                        if (now - lastTickTime > idealInterval) {
                            const visualCenter = Math.abs(currentX) + containerCenter;
                            const idx = Math.floor(visualCenter / itemFullWidth);
                            if (idx !== lastHighlightIndex) {
                                tickSound.pause();
                                tickSound.currentTime = 0;
                                tickSound.play().catch(e => console.log("Erro ao tocar som: " + e.message));
                                lastTickTime = now;
                                lastHighlightIndex = idx;
                            }
                        }
                    }

                    lastX = currentX;
                    requestAnimationFrame(tickLoop);
                }

                requestAnimationFrame(tickLoop);
            }

            function girarRoleta() {
                if (isSpinning || vidas <= 0) return; 
                
                isSpinning = true;
                atualizarContadorVidas(); 
                resetLivesBtn.disabled = true; 
                resultado.textContent = "";
                probReal.textContent = "";

                const { premio: premioFinal, r } = escolherPremio();

                const indexAlvo = clones.findIndex((i, idx) => i.dataset.valor == premioFinal.valor && idx > 40);
                const index = indexAlvo !== -1 ? indexAlvo : 80;
                const destino = index * itemFullWidth - roleta.parentElement.offsetWidth / 2 + itemFullWidth / 2;

                requestAnimationFrame(() => {
                    roleta.style.transition = "transform 14s cubic-bezier(0.16, 1, 0.3, 1)";
                    roleta.style.transform = `translateX(-${destino}px)`;
                });

                iniciarTickDuranteGiro(14000);

                setTimeout(() => {
                    if (vidas > 0) {
                        vidas--; 
                        atualizarContadorVidas(); 
                    }

                    clones.forEach(i => i.classList.remove("highlight"));
                    clones[index].classList.add("highlight");
                    winSound.play();

                    let msg = "";
                    let cor = "#00ff99";

                    if (premioFinal.valor === "REPICK") {
                        msg = "Ma O√™ Tomou Repick üí•";
                        cor = "#ff3333";
                        const explosao = document.getElementById("explosao");
                        explosao.style.animation = "none";
                        explosao.offsetHeight;
                        explosao.style.animation = "boom 0.6s ease-out";
                    } 
                    else if (premioFinal.valor === "TIMEOUT") {
                        msg = "Tomou TimeOut üò¥";
                        cor = "#aaaaaa";
                    } 
                    else if (premioFinal.valor.startsWith("SKIN_")) {
                        const valorSkin = premioFinal.valor.split("_")[1]; 
                        msg = `Ganhou uma Skin de ${valorSkin} reais üéØ`;
                        cor = "#00ff99";
                        confetti.style.display = "block";
                        setTimeout(() => confetti.style.display = "none", 2500);
                    }
                    else if (premioFinal.valor === "PIX_50") {
                        msg = "Quem quer dinheiro? Ganhou 50 reais!! üí∏";
                        cor = "#00ffff";
                        confetti.style.display = "block";
                        setTimeout(() => confetti.style.display = "none", 2500);
                    }

                    resultado.style.color = cor;
                    resultado.textContent = msg;
                    probReal.textContent = `Probabilidade de Sorteio: ${(premioFinal.prob * 100).toFixed(2)}%`;

                    isSpinning = false;
                    resetLivesBtn.disabled = false;
                    atualizarContadorVidas(); 
                }, 14000);
            }

            function resetarVidas() {
                vidas = 3;
                atualizarContadorVidas();
                resultado.textContent = "Vidas Resetadas! Gire a Roleta! üéâ";
                resultado.style.color = "#00ff99";
                probReal.textContent = "";
                gerarItens();
            }

            spinBtn.addEventListener("click", () => {
                if (isSpinning || vidas <= 0) return;
                gerarItens();
                setTimeout(() => girarRoleta(), 100);
            });

            resetLivesBtn.addEventListener("click", () => {
                const confirma = confirm("Voc√™ tem certeza que quer resetar as vidas?");
                if (confirma) {
                    resetarVidas();
                }
            });

            preencherBarraPremios();
            gerarItens();
            atualizarContadorVidas(); 
        });
    </script>
</body>
</html>
